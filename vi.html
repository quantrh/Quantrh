```html
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Demo Multi-Pocket</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    .hidden { display: none; }
    .container { max-width: 900px; margin: 20px auto; padding: 0 10px; }
    .card { position: relative; border: 1px solid #ccc; border-radius: 4px; padding: 10px; margin: 10px; display: inline-block; width: calc(48% - 22px); vertical-align: top; }
    .card h4 { margin: 0 0 5px; }
    .card .actions { position: absolute; top: 5px; right: 5px; }
    .actions button { margin-left: 5px; background: #ddd; border: none; padding: 2px 6px; cursor: pointer; border-radius: 3px; }
    .actions .delete-btn { background: #e74c3c; color: #fff; }
    .actions .edit-btn   { background: #3498db; color: #fff; }
    .progress { background: #eee; border-radius: 4px; overflow: hidden; height: 10px; margin: 5px 0; }
    .progress-bar { height: 10px; background: #4caf50; width: 0; }
    .form-group { margin-bottom: 10px; }
    label { display: block; margin-bottom: 3px; font-weight: bold; }
    input, select, button { width: 100%; padding: 6px; box-sizing: border-box; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 6px; text-align: left; }
    .modal, .popup { position: fixed; background: #fff; border: 1px solid #888; border-radius: 4px; padding: 15px; z-index: 10; }
    .modal { width: 300px; top: 50px; right: 50px; }
    .popup { top: 20px; right: 20px; display: none; }
    h3 { margin-top: 30px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div id="login-form" class="container">
  <h2>ƒêƒÉng nh·∫≠p / eKYC</h2>
  <div class="form-group"><label for="fullName">H·ªç v√† t√™n</label><input id="fullName" type="text"></div>
  <div class="form-group"><label for="idNumber">CMND/CCCD</label><input id="idNumber" type="text"></div>
  <button id="loginBtn">X√°c th·ª±c</button>
</div>

<div id="app" class="container hidden">
  <h2>Multi-Pocket Demo</h2>

  <!-- T·ªïng quan v√† qu·∫£n l√Ω ngƒÉn -->
  <section id="overview">
    <h3>T·ªïng quan t√†i kho·∫£n</h3>
    <div id="pockets"></div>
    <button id="addPocketBtn">T·∫°o ngƒÉn m·ªõi</button>
  </section>

  <!-- C·∫•u h√¨nh t·ª∑ l·ªá ph√¢n b·ªï -->
  <section id="allocation">
    <h3>C·∫•u h√¨nh t·ª∑ l·ªá ph√¢n b·ªï</h3>
    <table id="allocTable">
      <thead><tr><th>NgƒÉn</th><th>T·ª∑ l·ªá (%)</th></tr></thead>
      <tbody></tbody>
    </table>
    <button id="saveAlloc">L∆∞u t·ª∑ l·ªá</button>
  </section>

  <!-- N·ªôp ti·ªÅn v√†o v√≠ -->
  <section id="deposit">
    <h3>N·ªôp ti·ªÅn v√†o v√≠</h3>
    <div class="form-group"><label for="depositAmount">S·ªë ti·ªÅn</label><input id="depositAmount" type="number"></div>
    <button id="depositBtn">N·ªôp ti·ªÅn</button>
  </section>

  <!-- R√∫t ti·ªÅn t·ª´ v√≠ -->
  <section id="withdraw">
    <h3>R√∫t ti·ªÅn t·ª´ v√≠</h3>
    <div class="form-group"><label for="withdrawAmount">S·ªë ti·ªÅn</label><input id="withdrawAmount" type="number"></div>
    <button id="withdrawBtn">R√∫t ti·ªÅn</button>
  </section>

  <!-- ƒê·ªãnh k·ª≥ tr√≠ch n·ª£ -->
  <section id="recurring">
    <h3>Thi·∫øt l·∫≠p ƒë·ªãnh k·ª≥</h3>
    <div class="form-group"><label for="rPocket">Ch·ªçn ngƒÉn</label><select id="rPocket"></select></div>
    <div class="form-group"><label for="rAmount">S·ªë ti·ªÅn</label><input id="rAmount" type="number"></div>
    <div class="form-group"><label for="rFreq">T·∫ßn su·∫•t</label><select id="rFreq">
      <option>H√†ng ng√†y</option><option>H√†ng tu·∫ßn</option><option>H√†ng th√°ng</option>
    </select></div>
    <div class="form-group"><label for="rDate">Ng√†y b·∫Øt ƒë·∫ßu</label><input id="rDate" type="date"></div>
    <button id="saveRecurring">L∆∞u c·∫•u h√¨nh</button>
  </section>

  <!-- L·ªãch s·ª≠ giao d·ªãch -->
  <section id="transactions">
    <h3>L·ªãch s·ª≠ giao d·ªãch</h3>
    <table>
      <thead><tr><th>Ng√†y/Gi·ªù</th><th>S·ªë ti·ªÅn</th><th>NgƒÉn</th><th>Danh m·ª•c</th><th>S·ªë d∆∞</th></tr></thead>
      <tbody id="txBody"></tbody>
    </table>
  </section>

  <!-- Dashboard ƒë·ªì h·ªça -->
  <section id="charts">
    <h3>Dashboard</h3>
    <canvas id="pieChart" width="400" height="200"></canvas>
    <canvas id="barChart" width="400" height="200"></canvas>
  </section>
</div>

<!-- Modal t·∫°o/ch·ªânh s·ª≠a ngƒÉn -->
<div id="pocketModal" class="modal hidden">
  <h4>T·∫°o/Ch·ªânh s·ª≠a ngƒÉn</h4>
  <div class="form-group"><label for="pName">T√™n ngƒÉn</label><input id="pName" type="text"></div>
  <div class="form-group"><label for="pIcon">Bi·ªÉu t∆∞·ª£ng</label><select id="pIcon">
    <option>üí∞ Ti·∫øt ki·ªám</option><option>üõí Chi ti√™u</option><option>üéÅ Kh√°c</option>
  </select></div>
  <div class="form-group"><label for="pLimit">H·∫°n m·ª©c / M·ª•c ti√™u</label><input id="pLimit" type="number"></div>
  <button id="savePocket">L∆∞u</button>
</div>

<div id="popup" class="popup"></div>

<script>
(function(){
  const pocketsKey = 'mp_pockets', txKey = 'mp_txs', rcKey = 'mp_recurring';
  const load = (k,def)=> JSON.parse(localStorage.getItem(k))||def;
  const save = (k,v)=> localStorage.setItem(k, JSON.stringify(v));

  // Kh·ªüi t·∫°o d·ªØ li·ªáu m·∫∑c ƒë·ªãnh
  if(!localStorage.getItem(pocketsKey)){
    const defaultP = [
      {id:1,type:'spend',name:'Chi ti√™u',icon:'üõí',balance:0,limit:1000000},
      {id:2,type:'save', name:'Ti·∫øt ki·ªám',icon:'üí∞',balance:0,target:500000}
    ];
    // g√°n t·ª∑ l·ªá m·∫∑c ƒë·ªãnh ƒë·ªÅu nhau
    defaultP.forEach(p => p.ratio = 1/defaultP.length);
    save(pocketsKey, defaultP);
  }
  if(!localStorage.getItem(txKey)) save(txKey, []);
  if(!localStorage.getItem(rcKey)) save(rcKey, []);

  const popup = msg => {
    const p = document.getElementById('popup');
    p.textContent = msg; p.style.display='block';
    setTimeout(()=>p.style.display='none',3000);
  };

  // Render danh s√°ch ngƒÉn
  function renderPockets(){
    const cont = document.getElementById('pockets');
    cont.innerHTML = '';
    const pockets = load(pocketsKey,[]);
    // ƒë·∫£m b·∫£o c√≥ ratio
    if(!pockets.every(p=>p.ratio!=null)){
      const r = 1/pockets.length;
      pockets.forEach(p=>p.ratio = r);
      save(pocketsKey,pockets);
    }
    pockets.forEach(p=>{
      const card = document.createElement('div');
      card.className='card';
      card.innerHTML = `
        <div class="actions">
          <button class="edit-btn" data-id="${p.id}">S·ª≠a</button>
          <button class="delete-btn" data-id="${p.id}">X√≥a</button>
        </div>
        <h4>${p.icon} ${p.name}</h4>
        <p>S·ªë d∆∞: ${p.balance.toLocaleString()}</p>
        ${p.type==='save'
          ? `<div class="progress"><div class="progress-bar" style="width:${Math.min(100,(p.balance/p.target*100).toFixed(1))}%"></div></div>
             <p>${(p.balance/p.target*100).toFixed(1)}% ho√†n th√†nh</p>`
          : `<p>H·∫°n m·ª©c: ${p.limit.toLocaleString()}</p>`}
      `;
      cont.appendChild(card);
    });
    bindPocketActions();
    renderAllocTable();
    renderRecurringSelect();
  }

  // X·ª≠ l√Ω n√∫t S·ª≠a/X√≥a
  function bindPocketActions(){
    const pockets = load(pocketsKey,[]);
    document.querySelectorAll('.delete-btn').forEach(btn=>{
      btn.onclick = ()=>{
        const id = +btn.dataset.id;
        let arr = load(pocketsKey,[]);
        const p = arr.find(x=>x.id===id);
        // l∆∞u l·ªãch s·ª≠ giao d·ªãch
        const txs = load(txKey,[]);
        txs.push({
          datetime: new Date().toLocaleString(),
          amount: p.balance,
          pocket: p.name,
          category: 'X√≥a ngƒÉn',
          postBalance: 0
        });
        save(txKey,txs);
        arr = arr.filter(x=>x.id!==id);
        save(pocketsKey,arr);
        renderPockets(); renderTxs(); renderCharts();
        popup(`ƒê√£ x√≥a ngƒÉn "${p.name}"`);
      };
    });
    document.querySelectorAll('.edit-btn').forEach(btn=>{
      btn.onclick = ()=>{
        const id = +btn.dataset.id;
        const p = load(pocketsKey,[]).find(x=>x.id===id);
        editingId = id;
        document.getElementById('pName').value = p.name;
        document.getElementById('pIcon').value = (p.type==='save'?'üí∞ Ti·∫øt ki·ªám':'üõí Chi ti√™u');
        document.getElementById('pLimit').value = p.type==='save'? p.target : p.limit;
        document.getElementById('pocketModal').classList.remove('hidden');
      };
    });
  }

  // Render b·∫£ng t·ª∑ l·ªá ph√¢n b·ªï
  function renderAllocTable(){
    const tbody = document.querySelector('#allocTable tbody');
    tbody.innerHTML = '';
    load(pocketsKey,[]).forEach(p=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${p.name}</td>
        <td><input type="number" min="0" max="100" data-id="${p.id}" value="${(p.ratio*100).toFixed(0)}"></td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Render l·ª±a ch·ªçn ƒë·ªãnh k·ª≥
  function renderRecurringSelect(){
    const sel = document.getElementById('rPocket');
    sel.innerHTML = load(pocketsKey,[]).map(p=>
      `<option value="${p.id}">${p.name}</option>`
    ).join('');
  }

  // Render giao d·ªãch
  function renderTxs(){
    const tbody = document.getElementById('txBody');
    tbody.innerHTML = '';
    load(txKey,[]).forEach(tx=>{
      const row = `<tr>
        <td>${tx.datetime}</td>
        <td>${tx.amount.toLocaleString()}</td>
        <td>${tx.pocket}</td>
        <td>${tx.category}</td>
        <td>${tx.postBalance.toLocaleString()}</td>
      </tr>`;
      tbody.insertAdjacentHTML('beforeend',row);
    });
  }

  // Render bi·ªÉu ƒë·ªì
  function renderCharts(){
    const pockets = load(pocketsKey,[]);
    const spending = pockets.filter(p=>p.type==='spend').reduce((s,p)=>s+p.balance,0);
    const saving   = pockets.filter(p=>p.type==='save').reduce((s,p)=>s+p.balance,0);
    new Chart(document.getElementById('pieChart'), {
      type:'pie',
      data:{labels:['Chi ti√™u','Ti·∫øt ki·ªám'],datasets:[{data:[spending,saving]}]}
    });
    new Chart(document.getElementById('barChart'), {
      type:'bar',
      data:{
        labels:['Thg1','Thg2','Thg3','Thg4','Thg5'],
        datasets:[{label:'Chi ti√™u',data:[200,300,250,400,350]}]
      }
    });
  }

  // N·∫°p d·ªØ li·ªáu v√† hi·ªÉn th·ªã
  document.getElementById('loginBtn').onclick = ()=>{
    document.getElementById('login-form').classList.add('hidden');
    document.getElementById('app').classList.remove('hidden');
    renderPockets(); renderTxs(); renderCharts();
  };

  // T·∫°o / S·ª≠a ngƒÉn
  let editingId = null;
  document.getElementById('addPocketBtn').onclick = ()=>{
    editingId = null;
    document.getElementById('pName').value = '';
    document.getElementById('pIcon').value = 'üí∞ Ti·∫øt ki·ªám';
    document.getElementById('pLimit').value = '';
    document.getElementById('pocketModal').classList.remove('hidden');
  };
  document.getElementById('savePocket').onclick = ()=>{
    const name = document.getElementById('pName').value;
    const icon = document.getElementById('pIcon').value.split(' ')[0];
    const lim  = Number(document.getElementById('pLimit').value) || 0;
    const arr = load(pocketsKey,[]);
    if(editingId){
      const p = arr.find(x=>x.id===editingId);
      p.name=name; p.icon=icon;
      if(p.type==='save') p.target=lim; else p.limit=lim;
    } else {
      const id = Date.now();
      const type = document.getElementById('pIcon').value.includes('Ti·∫øt')?'save':'spend';
      arr.push({
        id, type, name, icon, balance:0,
        ...(type==='save'?{target:lim}:{limit:lim}),
        ratio:1/arr.length
      });
      // ƒëi·ªÅu ch·ªânh l·∫°i ratio ƒë·ªÅu nhau
      const newRatio = 1/arr.length;
      arr.forEach(x=>x.ratio=newRatio);
    }
    save(pocketsKey,arr);
    document.getElementById('pocketModal').classList.add('hidden');
    renderPockets(); renderCharts();
    popup('ƒê√£ l∆∞u ngƒÉn');
  };

  // L∆∞u t·ª∑ l·ªá ph√¢n b·ªï
  document.getElementById('saveAlloc').onclick = ()=>{
    const inputs = document.querySelectorAll('#allocTable input');
    const arr = load(pocketsKey,[]);
    let sum=0;
    inputs.forEach(i=> sum+=Number(i.value));
    if(sum!==100){ popup('T·ªïng t·ª∑ l·ªá ph·∫£i l√† 100%'); return; }
    inputs.forEach(i=>{
      const p = arr.find(x=>x.id===+i.dataset.id);
      p.ratio = Number(i.value)/100;
    });
    save(pocketsKey,arr);
    popup('ƒê√£ l∆∞u t·ª∑ l·ªá ph√¢n b·ªï');
  };

  // N·ªôp ti·ªÅn
  document.getElementById('depositBtn').onclick = ()=>{
    const amt = Number(document.getElementById('depositAmount').value);
    if(amt<=0){ popup('S·ªë ti·ªÅn kh√¥ng h·ª£p l·ªá'); return; }
    const arr = load(pocketsKey,[]);
    const txs = load(txKey,[]);
    let remainder = amt;
    arr.forEach((p,i)=>{
      const share = Math.floor(amt * p.ratio);
      p.balance += share;
      remainder -= share;
      txs.push({
        datetime: new Date().toLocaleString(),
        amount: share,
        pocket: p.name,
        category: 'N·ªôp ti·ªÅn',
        postBalance: p.balance
      });
    });
    // ph·∫ßn d∆∞ c√≤n l·∫°i c·ªông v√†o ngƒÉn ƒë·∫ßu ti√™n
    if(remainder>0 && arr.length){
      arr[0].balance += remainder;
      txs.push({
        datetime: new Date().toLocaleString(),
        amount: remainder,
        pocket: arr[0].name,
        category: 'N·ªôp ti·ªÅn (ph·∫ßn d∆∞)',
        postBalance: arr[0].balance
      });
    }
    save(pocketsKey,arr);
    save(txKey,txs);
    renderPockets(); renderTxs(); renderCharts();
    popup('N·ªôp ti·ªÅn th√†nh c√¥ng');
  };

  // R√∫t ti·ªÅn
  document.getElementById('withdrawBtn').onclick = ()=>{
    const amt = Number(document.getElementById('withdrawAmount').value);
    if(amt<=0){ popup('S·ªë ti·ªÅn kh√¥ng h·ª£p l·ªá'); return; }
    const arr = load(pocketsKey,[]);
    const txs = load(txKey,[]);
    let totalDeducted = 0;
    arr.forEach(p=>{
      const ded = Math.min(Math.floor(amt * p.ratio), p.balance);
      p.balance -= ded;
      totalDeducted += ded;
      txs.push({
        datetime: new Date().toLocaleString(),
        amount: -ded,
        pocket: p.name,
        category: 'R√∫t ti·ªÅn',
        postBalance: p.balance
      });
    });
    if(totalDeducted < amt) popup('Kh√¥ng ƒë·ªß s·ªë d∆∞ theo t·ª∑ l·ªá, ƒë√£ r√∫t t·ªëi ƒëa c√≥ th·ªÉ');
    save(pocketsKey,arr);
    save(txKey,txs);
    renderPockets(); renderTxs(); renderCharts();
  };

})();
</script>
</body>
</html>
```
