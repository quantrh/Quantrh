<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Go-live Core Banking Myanmar V1.3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .task-card {
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.07), 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .task-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        .status-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>');
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.25em;
            padding-right: 2rem;
        }
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        .checkpoint {
            border-left: 4px solid #FFC62F; /* BIDV Yellow */
        }
        .golive-event {
             border-left: 4px solid #16a34a; /* Green 600 */
        }
        .timeline-container {
            position: relative;
        }
        #current-time-indicator-vertical {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #ef4444; /* Red 500 */
            z-index: 10;
        }
        #current-time-label-vertical {
            position: absolute;
            top: -10px;
            transform: translateX(-50%);
            background-color: #ef4444;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        #current-time-indicator-horizontal {
            position: relative;
            height: 2px;
            background-color: #ef4444;
            margin: 1rem 0;
            width: 100%;
        }
        #current-time-label-horizontal {
             position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            background-color: #ef4444;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        .gemini-btn, .lang-btn {
            background-color: #006B68; /* BIDV Green */
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .gemini-btn:hover, .lang-btn:hover {
            background-color: #004a48; /* Darker BIDV Green */
        }
        .lang-btn {
            min-width: 50px;
            text-align: center;
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 24px;
            border: 1px solid #888;
            width: 80%;
            max-width: 640px;
            border-radius: 8px;
            position: relative;
        }
        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-btn:hover,
        .close-btn:focus {
            color: black;
        }
         /* Spinner */
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #006B68; /* BIDV Green */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-screen-xl mx-auto">
        <!-- Header -->
        <div class="mb-8 text-center">
            <h1 id="header-title" class="text-3xl md:text-4xl font-bold text-[#006B68]"></h1>
            <div class="flex items-center justify-center gap-4 mt-2">
                <p id="header-subtitle" class="text-lg text-gray-600"></p>
                <button id="quick-report-btn" class="gemini-btn"></button>
                <button id="lang-switcher-btn" class="lang-btn"></button>
            </div>
        </div>
        
        <!-- Banner Image -->
        <div class="w-full h-48 md:h-64 bg-cover bg-center rounded-lg shadow-lg mb-8" style="background-image: url('https://images.unsplash.com/photo-1524178232363-1fb2b075b655?q=80&w=2070&auto=format&fit=crop');">
            <div class="w-full h-full bg-black bg-opacity-30 flex items-end p-6 rounded-lg">
                <div class="text-white">
                    <h2 class="text-2xl font-bold">Chiến dịch Golive Core Banking V1.3 & Quantum</h2>
                    <p class="opacity-90">Cập nhật theo CV 1452/CV-QLPTCB ngày 10/12/2025</p>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="mb-8">
            <div class="flex justify-between mb-1">
                <span id="progress-title" class="text-base font-medium text-[#006B68]"></span>
                <span class="text-sm font-medium text-[#006B68]" id="progress-text">0%</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="progress-bar" class="bg-[#006B68] h-2.5 rounded-full" style="width: 0%"></div>
            </div>
        </div>

        <!-- Task Columns -->
        <div class="timeline-container">
             <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="task-board">
                <!-- Columns will be generated by JavaScript -->
            </div>
            <div id="current-time-indicator-vertical" style="display: none;">
                <div id="current-time-label-vertical"></div>
            </div>
        </div>
    </div>
    
    <!-- Modal for Gemini Response -->
    <div id="gemini-modal" class="modal">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2 id="modal-title" class="text-2xl font-bold mb-4 text-gray-800"></h2>
        <div id="modal-body" class="prose max-w-none">
            <!-- Content will be injected here -->
        </div>
      </div>
    </div>


    <script>
        // --- Data from CV 1452 ---
        const taskStructure = {
            day1: [ 
                { id: 1, time: '09:00 - 18:00 MYT' }, 
                { id: 2, time: '17:00 MYT', type: 'checkpoint' }, 
                { id: 3, time: '17:00 - 20:00 MYT' },
                { id: 4, time: '20:00 - 23:00 MYT' },
                { id: 5, time: '23:00 MYT', type: 'checkpoint' }
            ],
            day2: [ 
                { id: 6, time: '13/12 - 14/12' }, 
                { id: 7, time: '13/12 - 14/12' },
                { id: 8, time: '17:00 MYT (14/12)', type: 'checkpoint' },
                { id: 9, time: 'Sau 17:00 (14/12)' }
            ],
            day3: [ 
                { id: 10, time: '09:00 MYT', type: 'golive' },
                { id: 11, time: 'Trong ngày' }
            ]
        };
        
        const translations = {
            vi: {
                header_title: "Dashboard Kế hoạch Go-live V1.3",
                header_subtitle: "Triển khai Core Banking Myanmar - Giai đoạn 2",
                quick_report_btn: "✨ Tạo Báo cáo Nhanh",
                lang_btn: "EN",
                progress_title: "Tiến độ tổng thể",
                current_time: "Hiện tại",
                modal_loading_title: "Đang xử lý...",
                modal_loading_text: "Vui lòng chờ trong giây lát...",
                risk_analysis_title: "✨ Phân tích Rủi ro & Đề xuất",
                quick_report_title: "✨ Báo cáo Nhanh Trạng thái Dự án",
                risk_analysis_btn: "✨ Phân tích Rủi ro",
                statuses: { pending: 'Chưa bắt đầu', inprogress: 'Đang thực hiện', done: 'Hoàn thành', blocked: 'Bị chặn' },
                days: { 
                    day1: "Thứ 6, 12/12/2025 (Ngày Cập Nhật)", 
                    day2: "13-14/12/2025 (Hậu kiểm & Batchrun)", 
                    day3: "Thứ 2, 15/12/2025 (GO-LIVE)" 
                },
                tasks: {
                    1: { task: 'Nhập giao dịch chuyển đổi & Smoke Test Quantum. (09:00-10:00: Nhập GD; 10:00-18:00: Kiểm thử)', assignee: 'Chi nhánh Yangon, Ban QLDA CBM' },
                    2: { task: 'CHECKPOINT #1: Hoàn thành kiểm thử với các tính năng Quantum.', assignee: 'Ban QLDA CBM' },
                    3: { task: 'Cài đặt gói cập nhật Core Profile V1.3, Quantum và các ứng dụng tích hợp (SWIFT, CCS, BSMS...). Backup trước khi nâng cấp.', assignee: 'Ban QLPTCB, TTCNTT, TT PTPM' },
                    4: { task: 'Kiểm thử Smoke test V1.3, Kiểm thử tích hợp Quantum (CCS, SWIFT, GL...). Kiểm thử các ứng dụng sau nâng cấp.', assignee: 'Ban QLDA CBM, Chi nhánh Yangon' },
                    5: { task: 'CHECKPOINT #2: Hoàn thành kiểm thử tính năng nâng cấp Profile & Tích hợp. Quyết định GO/NO GO.', assignee: 'Ban QLDA CBM, Chi nhánh Yangon' },
                    6: { task: 'Thực hiện công việc sau CP2: Batchrun Profile, Backup DB, Start dịch vụ Online. Kiểm tra D+1 (MIS, GL).', assignee: 'Ban QLPTCB, TTCNTT, Ban QLDA, CN Yangon' },
                    7: { task: 'Kiểm thử và fix lỗi phân hệ KDV và tiền tệ trên Quantum (nếu có).', assignee: 'Ban QLDA CBM, CN Yangon' },
                    8: { task: 'CHECKPOINT #3: Hoàn thành kiểm thử thông luồng tích hợp Quantum với các ứng dụng liên quan.', assignee: 'Ban QLDA CBM, CN Yangon' },
                    9: { task: 'Kiểm tra hệ thống sau báo cáo triển khai D+2. Chạy EOD Quantum, Batchrun Profile.', assignee: 'Ban QLDA CBM, CN Yangon' },
                    10: { task: 'GO-LIVE: Hệ thống Profile V1.3 và Quantum chính thức hoạt động.', assignee: 'Chi nhánh Yangon' },
                    11: { task: 'Chi nhánh đăng nhập hệ thống (WebCSR, TP Teller, Quantum...) thực hiện giao dịch.', assignee: 'Ban QLDA CBM, CN Yangon' }
                }
            },
            en: {
                header_title: "Go-live Dashboard V1.3",
                header_subtitle: "Core Banking Myanmar Implementation - Phase 2",
                quick_report_btn: "✨ Quick Report",
                lang_btn: "VI",
                progress_title: "Overall Progress",
                current_time: "Current",
                modal_loading_title: "Processing...",
                modal_loading_text: "Please wait a moment...",
                risk_analysis_title: "✨ Risk Analysis & Recommendations",
                quick_report_title: "✨ Project Status Quick Report",
                risk_analysis_btn: "✨ Analyze Risk",
                statuses: { pending: 'Pending', inprogress: 'In Progress', done: 'Completed', blocked: 'Blocked' },
                days: { 
                    day1: "Fri, 12/12/2025 (Update Day)", 
                    day2: "13-14/12/2025 (Post-check & Batchrun)", 
                    day3: "Mon, 15/12/2025 (GO-LIVE)" 
                },
                tasks: {
                    1: { task: 'Input conversion transactions & Smoke Test Quantum. (09:00-10:00: Input; 10:00-18:00: Test)', assignee: 'Yangon Branch, PMO CBM' },
                    2: { task: 'CHECKPOINT #1: Complete testing of Quantum features.', assignee: 'PMO CBM' },
                    3: { task: 'Install Core Profile V1.3 update package, Quantum, and integrations (SWIFT, CCS, BSMS...). Backup before upgrade.', assignee: 'Core Banking Dev, IT Center, Software Dev' },
                    4: { task: 'Smoke Test V1.3, Quantum Integration Test (CCS, SWIFT, GL...). Test applications after upgrade.', assignee: 'PMO CBM, Yangon Branch' },
                    5: { task: 'CHECKPOINT #2: Complete Profile upgrade & Integration testing. GO/NO GO Decision.', assignee: 'PMO CBM, Yangon Branch' },
                    6: { task: 'Post-CP2 tasks: Batchrun Profile, Backup DB, Start Online services. Check D+1 (MIS, GL).', assignee: 'Core Banking Dev, IT Center, PMO, Yangon Branch' },
                    7: { task: 'Test and fix Treasury module bugs on Quantum (if any).', assignee: 'PMO CBM, Yangon Branch' },
                    8: { task: 'CHECKPOINT #3: Complete end-to-end integration testing of Quantum.', assignee: 'PMO CBM, Yangon Branch' },
                    9: { task: 'System check after D+2 report. Run EOD Quantum, Batchrun Profile.', assignee: 'PMO CBM, Yangon Branch' },
                    10: { task: 'GO-LIVE: Profile V1.3 and Quantum systems officially live.', assignee: 'Yangon Branch' },
                    11: { task: 'Branch logs into systems (WebCSR, TP Teller, Quantum...) to perform transactions.', assignee: 'PMO CBM, Yangon Branch' }
                }
            }
        };

        const defaultStatuses = { 1: 'done', 2: 'done', 3: 'inprogress', 4: 'pending', 5: 'pending', 6: 'pending', 7: 'pending', 8: 'pending', 9: 'pending', 10: 'pending', 11: 'pending' };
        
        let taskStatuses = defaultStatuses;
        let currentLang = 'vi';

        const statusConfig = {
            pending:    { text_key: 'pending',   bg: 'bg-slate-100', text_color: 'text-slate-600' },
            inprogress: { text_key: 'inprogress',  bg: 'bg-amber-100', text_color: 'text-amber-800' },
            done:       { text_key: 'done',       bg: 'bg-teal-100', text_color: 'text-[#006B68]' },
            blocked:    { text_key: 'blocked',         bg: 'bg-rose-100', text_color: 'text-rose-700' }
        };

        const dayIcons = { day1: 'fa-solid fa-server', day2: 'fa-solid fa-database', day3: 'fa-solid fa-rocket' };

        const taskBoard = document.getElementById('task-board');
        const modal = document.getElementById('gemini-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const closeBtn = document.querySelector('.close-btn');

        // Placeholder API URL - Replace with real key if needed
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=YOUR_API_KEY_HERE`; 

        // Mock function to simulate API response since no key provided
        async function callGeminiAPI(prompt) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve(`
                        <h3>Mô phỏng Phân tích AI</h3>
                        <p>Do chưa có API Key thực tế, đây là nội dung mô phỏng dựa trên yêu cầu của bạn:</p>
                        <ul class="list-disc list-inside space-y-1">
                            <li class="text-gray-600">Hệ thống ghi nhận trạng thái hiện tại.</li>
                            <li class="text-gray-600">Đề xuất kiểm tra kỹ thuật các bước tiếp theo.</li>
                            <li class="text-gray-600">Vui lòng cập nhật API Key trong mã nguồn để sử dụng tính năng AI thực tế.</li>
                        </ul>
                    `);
                }, 1500);
            });
        }

        function showModal(title, content) {
            modalTitle.textContent = title;
            modalBody.innerHTML = content;
            modal.style.display = 'block';
        }

        function showLoading() {
            showModal(translations[currentLang].modal_loading_title, `<div class="loader"></div><p class="text-center">${translations[currentLang].modal_loading_text}</p>`);
        }
        
        closeBtn.onclick = () => modal.style.display = 'none';
        window.onclick = (event) => { if (event.target == modal) modal.style.display = 'none'; };

        async function handleRiskAnalysis(taskId, dayKey) {
            const task = translations[currentLang].tasks[taskId];
            if (!task) return;
            showLoading();
            // In real scenario, use prompt
            const analysis = await callGeminiAPI("risk_prompt");
            showModal(translations[currentLang].risk_analysis_title, analysis);
        }

        document.getElementById('quick-report-btn').addEventListener('click', async () => {
            showLoading();
            // In real scenario, construct report data
            const summary = await callGeminiAPI("report_prompt");
            showModal(translations[currentLang].quick_report_title, summary);
        });

        function renderAllUI() {
            document.documentElement.lang = currentLang;
            const T = translations[currentLang];
            
            // Update static text
            document.getElementById('header-title').textContent = T.header_title;
            document.getElementById('header-subtitle').textContent = T.header_subtitle;
            document.getElementById('quick-report-btn').textContent = T.quick_report_btn;
            document.getElementById('lang-switcher-btn').textContent = T.lang_btn;
            document.getElementById('progress-title').textContent = T.progress_title;
            document.getElementById('current-time-label-vertical').textContent = T.current_time;
            
            // Render dynamic task board
            taskBoard.innerHTML = '';
            let totalTasks = 0;
            let completedTasks = 0;
            let taskCounter = 1;

            for (const dayKey in taskStructure) {
                const dayColumn = document.createElement('div');
                dayColumn.className = 'bg-white/60 backdrop-blur-sm p-4 rounded-lg shadow-sm';
                let dayTitleColor = T.days[dayKey].includes("GO-LIVE") ? "text-[#006B68] font-bold" : "text-gray-700";
                let iconHTML = `<i class="${dayIcons[dayKey]} mr-2 text-[#006B68] opacity-80"></i>`;
                
                dayColumn.innerHTML = `<h2 class="text-xl font-semibold mb-4 pb-2 border-b ${dayTitleColor} flex items-center">${iconHTML}${T.days[dayKey]}</h2>`;
                const tasksContainer = document.createElement('div');
                tasksContainer.className = 'space-y-4';
                
                taskStructure[dayKey].forEach(taskInfo => {
                    const taskId = taskInfo.id;
                    const taskStatusKey = taskStatuses[taskId];
                    const status = statusConfig[taskStatusKey] || statusConfig.pending;
                    const taskData = T.tasks[taskId];

                    totalTasks++;
                    if (taskStatusKey === 'done') completedTasks++;

                    const taskCard = document.createElement('div');
                    taskCard.setAttribute('data-task-id', taskId);
                    taskCard.className = `task-card relative p-4 rounded-lg ${status.bg} ${taskInfo.type || ''}`;

                    let geminiButtonHTML = '';
                    if (taskStatusKey === 'blocked') {
                        geminiButtonHTML = `<button data-id="${taskId}" data-day-key="${dayKey}" class="risk-analysis-btn mt-3 w-full text-sm font-semibold text-rose-700 hover:text-rose-900">${T.risk_analysis_btn}</button>`;
                    }

                    let taskText = taskData.task;
                    const highlightClass = 'font-bold text-green-600';
                    taskText = taskText.replace(/CHECKPOINT|GO-LIVE|GO\/NO GO/g, match => `<strong class="${highlightClass}">${match}</strong>`);

                    const taskNumberHTML = `<div class="absolute -top-3 -left-3 flex items-center justify-center w-7 h-7 rounded-full bg-[#006B68] text-[#FFC62F] font-bold text-sm shadow-md">${taskCounter}</div>`;

                    let statusOptionsHTML = '';
                    for (const key in T.statuses) {
                        statusOptionsHTML += `<option value="${key}" ${taskStatusKey === key ? 'selected' : ''}>${T.statuses[key]}</option>`;
                    }

                    taskCard.innerHTML = `
                        ${taskNumberHTML}
                        <div class="flex justify-between items-start">
                            <p class="text-sm font-semibold ${status.text_color} opacity-80">${taskInfo.time}</p>
                            <select data-id="${taskId}" class="status-select text-xs font-medium rounded border-gray-300 focus:ring-[#006B68] focus:border-[#006B68]">${statusOptionsHTML}</select>
                        </div>
                        <p class="font-medium ${status.text_color} my-2">${taskText}</p>
                        <div class="flex items-center mt-2 ${status.text_color} opacity-90">
                            <svg class="w-4 h-4 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg>
                            <p class="text-sm" title="${taskData.assignee}">${taskData.assignee}</p>
                        </div>
                        ${geminiButtonHTML}`;
                    
                    tasksContainer.appendChild(taskCard);
                    taskCounter++;
                });
                dayColumn.appendChild(tasksContainer);
                taskBoard.appendChild(dayColumn);
            }
            const progress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('progress-text').innerText = `${progress}%`;
            
            updateCurrentTimeIndicator();
        }
        
        function updateCurrentTimeIndicator() {
            const verticalIndicator = document.getElementById('current-time-indicator-vertical');
            verticalIndicator.style.display = 'none';
            const oldHorizontal = document.getElementById('current-time-indicator-horizontal');
            if (oldHorizontal) oldHorizontal.remove();
            
            // Logic timeline indicator - Simplified for Demo
            // In real app, calculate based on 12/12 to 15/12
        }
        
        // --- Event Listeners ---
        document.getElementById('lang-switcher-btn').addEventListener('click', () => {
            currentLang = currentLang === 'vi' ? 'en' : 'vi';
            renderAllUI();
        });

        taskBoard.addEventListener('change', (e) => {
            if (e.target.classList.contains('status-select')) {
                const taskId = e.target.dataset.id;
                taskStatuses[taskId] = e.target.value;
                renderAllUI();
            }
        });
        
        taskBoard.addEventListener('click', (e) => {
            if (e.target.classList.contains('risk-analysis-btn')) {
                const taskId = parseInt(e.target.dataset.id);
                const dayKey = e.target.dataset.dayKey;
                handleRiskAnalysis(taskId, dayKey);
            }
        });

        window.addEventListener('resize', updateCurrentTimeIndicator);
        
        // --- Initial Load ---
        renderAllUI();

    </script>
</body>
</html>